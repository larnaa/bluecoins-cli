# bluecoins-cli

> ðŸš§ **WARNING** ðŸš§
> 
> This sortware is at the very early stage of development. Use at your own risk and make sure to always have a database backup!

A CLI tool to manage the database of Bluecoins, an awesome budget planner for Android.

## Installation

You need GNU Make and Poetry installed. Run `make` to perform an entire CI pipeline - install dependencies, run linters and tests.

## Usage

1. Open the Bluecoins app. Go to *Settings -> Data Management -> Phone Storage -> Backup to phone storage*.
2. Transfer created `*.fydb` database backup file to the PC.
3. Run `bluecoins-cli mybackup.fydb convert` to convert a database to USD base currency.
4. Transfer created `mybackup.new.fydb` file to the smartphone. Go to *Settings -> Data Management -> Phone Storage -> Restore from phone storage*. Choose created file.

## Bluecoins database structure

`*.fydb` files generated by Bluecoins export are plain SQLite databases:

```text
âžœ  ~ file Bluecoins_2022-03-19_00_57_22.fydb 
Bluecoins_2022-03-19_00_57_22.fydb: SQLite 3.x database, user version 42, last written using SQLite version 3032002, file counter 11888, database pages 154, cookie 0x16, schema 4, largest root page 25, UTF-8, version-valid-for 11888
```

e.g., transactions are stored in `TRANSACTIONSTABLE` table. Columns we are interested in `convert` command scope are `transactionCurrency` and `conversionRateNew`.

```sql
SELECT transactionsTableID, conversionRateNew, transactionCurrency FROM TRANSACTIONSTABLE WHERE transactionCurrency != 'RUB' limit 5;
transactionsTableID  conversionRateNew   transactionCurrency
-------------------  ------------------  -------------------
1589351855443        0.0112947956665299  EUR                
1589351896182        0.0125486150829316  EUR                
1589352019668        0.011549686321133   EUR                
1589352314955        0.0125486150829316  EUR                
1589352314956        0.0125486150829316  EUR                
```

Another example, select all categories and their groups:

```sql
SELECT G.categoryGroupID, G.parentCategoryName, C.childCategoryName FROM CHILDCATEGORYTABLE C JOIN PARENTCATEGORYTABLE G ON C.parentCategoryID = G.parentCategoryTableID ORDER BY G.parentCategoryName, C.childCategoryName;
```
___

##  An archive command to move all account transactions to the virtual Archive account #6 

1. Hides/deletes archive-account from the account list.
    - Find accounts table.
    - Find all tables with archive-account.
    - Delete archive-account.
2. Add teg to all transactions of archive-account. example: #bank_USD
    - Find transactions table.
    - Hide account from account selection. Change in ACCOUNTSTABLE: accountSelectorVisibility=1.
    - Add a teg to the teg column in the table for each transaction that has archive-account in the account column.


#### Hide from account selection and all reports

**App**
- transaction tab: hide in filter
- transaction tab: hide selected account transactions
- create transaction page: hide from account list
- main page: hide from reports

**BD**
- `TRANSACTIONSTABL` - no changes
- `ACCOUNTSTABLE` - accountHidden=1

#### Hide from account selection

**App**
- transaction tab: hide in filter
- create transaction page: hide from account list

**BD**
- `ACCOUNTSTABLE` - accountSelectorVisibility=1



*In backup keep the language preference interface.*
- `SETTINGSTABLE` - 2=%language%


*Tables:*
- `ACCOUNTSTABLE` - all created accounts;
- `ACCOUNTTYPETABLE` - static info

```text
format beautiful SQL tables
.headers on
.mode column

pragma table_info(?TABLE?); - view columns name
```
